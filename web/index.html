<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raven Network Monitoring - Enhanced</title>
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">
</head>
<body>
    <div id="app" :data-theme="theme" class="app" :class="{ 'sidebar-collapsed': sidebarCollapsed }">
        <!-- Sidebar Overlay for Mobile -->
        <div class="sidebar-overlay" :class="{ active: sidebarOpen }" @click="closeSidebar"></div>
        
        <!-- Sidebar Component -->
        <sidebar-component 
            :current-view="currentView"
            :sidebar-open="sidebarOpen"
            :sidebar-collapsed="sidebarCollapsed"
            :web-config="webConfig"
            @set-view="setView"
            @toggle-sidebar-collapse="toggleSidebarCollapse">
        </sidebar-component>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header Component -->
            <header-component
                :page-title="pageTitle"
                :connected="connected"
                :theme="theme"
                :current-view="currentView"
                @toggle-sidebar="toggleSidebar"
                @toggle-theme="toggleTheme"
                @open-add-host-modal="openAddHostModal">
            </header-component>

            <!-- Dashboard View -->
            <dashboard-view v-if="currentView === 'dashboard'"
                :stats="stats"
                :recent-activity="recentActivity">
            </dashboard-view>

            <!-- Hosts View -->
            <hosts-view v-if="currentView === 'hosts'"
                ref="hostsView"
                :hosts="hosts"
                :loading="loading"
                :search-query="searchQuery"
                :filter-group="filterGroup"
                :groups="groups"
                :filtered-hosts="filteredHosts"
                @update:search-query="searchQuery = $event"
                @update:filter-group="filterGroup = $event"
                @edit-host="editHost"
                @delete-host="deleteHost"
                @view-host-detail="showHostDetail">
            </hosts-view>

            <!-- Host Detail View -->
            <host-detail-view v-if="currentView === 'host-detail'"
                :host="currentHostDetail"
                :host-statuses="hostStatuses"
                :loading="loadingHostDetail"
                :loading-statuses="loadingHostStatuses"
                @back-to-hosts="backToHosts"
                @refresh-host-data="refreshHostData">
            </host-detail-view>

            <!-- Checks View -->
            <checks-view v-if="currentView === 'checks'"
                :checks="checks"
                :loading="loading"
                :search-checks-query="searchChecksQuery"
                :filter-check-type="filterCheckType"
                :check-types="checkTypes"
                :filtered-checks="filteredChecks"
                @update:search-checks-query="searchChecksQuery = $event"
                @update:filter-check-type="filterCheckType = $event"
                @open-add-check-modal="openAddCheckModal"
                @edit-check="editCheck"
                @delete-check="deleteCheck">
            </checks-view>

            <!-- Alerts View -->
            <alerts-view v-if="currentView === 'alerts'"
                :alerts="alerts"
                :loading="loading"
                :alert-metrics="alertMetrics"
                :alert-filter="alertFilter"
                :filtered-alerts="filteredAlerts"
                @update:alert-filter="alertFilter = $event"
                @view-alert-detail="showAlertDetail">
            </alerts-view>

            <!-- Alert Detail View -->
            <alert-detail-view v-if="currentView === 'alert-detail'"
                :alert="currentAlertDetail"
                :affected-hosts="affectedHosts"
                :alert-statuses="alertStatuses"
                :loading="loadingAlertDetail"
                :loading-hosts="loadingAffectedHosts"
                @back-to-alerts="backToAlerts"
                @refresh-alert-data="refreshAlertData"
                @view-host-detail="viewHostDetailFromAlert">
            </alert-detail-view>

            <!-- Notification View -->
            <notifications-view v-if="currentView === 'notifications'" 
                ref="notificationsView">
            </notifications-view>

            <!-- About View -->
            <about-view v-if="currentView === 'about'"
                :build-info="buildInfo"
                :loading-build-info="loadingBuildInfo"
                :web-config="webConfig">
            </about-view>

            <!-- Settings View -->
            <settings-view v-if="currentView === 'settings'"
                :settings="settings"
                :connected="connected"
                :build-info="buildInfo"
                :web-config="webConfig"
                @toggle-theme="toggleTheme"
                @export-config="exportConfig"
                @refresh-data="refreshData">
            </settings-view>
        </div>

        <!-- Host Modal -->
        <host-modal
            :show="showHostModal"
            :editing="editingHost"
            :form="hostForm"
            :saving="saving"
            @close="closeHostModal"
            @save="saveHost">
        </host-modal>

        <!-- Check Modal -->
        <check-modal
            :show="showCheckModal"
            :editing="editingCheck"
            :form="checkForm"
            :hosts="hosts"
            :saving="saving"
            @close="closeCheckModal"
            @save="saveCheck">
        </check-modal>

        <!-- Notification -->
        <notification-component :notification="notification"></notification-component>
    </div>

    <!-- Load all JavaScript components BEFORE the main app -->
    <script src="js/utils.js"></script>
    <script src="js/api.js"></script>
    <script src="js/components/sidebar.js"></script>
    <script src="js/components/header.js"></script>
    <script src="js/components/dashboard-view.js"></script>
    <script src="js/components/hosts-view.js"></script>
    <script src="js/components/host-detail-view.js"></script>
    <script src="js/components/checks-view.js"></script>
    <script src="js/components/alerts-view.js"></script>
    <script src="js/components/alert-detail-view.js"></script>
    <script src="js/components/notifications-view.js"></script>
    <script src="js/components/about-view.js"></script>
    <script src="js/components/settings-view.js"></script>
    <script src="js/components/host-modal.js"></script>
    <script src="js/components/check-modal.js"></script>
    <script src="js/components/notification.js"></script>
    
    <!-- Load main app LAST -->
    <script src="js/app.js"></script>
</body>
</html>
